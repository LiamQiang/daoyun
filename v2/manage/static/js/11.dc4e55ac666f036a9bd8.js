webpackJsonp([11],{231:function(e,t,o){"use strict";function a(e){o(289)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(260),i=o(291),r=o(93),n=a,l=r(s.a,i.a,!1,n,"data-v-2ee312aa",null);t.default=l.exports},254:function(e,t,o){e.exports=o.p+"static/img/background0.d04d82e.png"},260:function(e,t,o){"use strict";var a=o(58),s=o.n(a),i=o(94),r=o(1),n=o(96),l=o.n(n);t.a={name:"Login2",data:function(){var e=this;return{users:{},ruleForm:{account:"",pass:""},ruleForm2:{tel:"",smscode:""},rules:{account:[{required:!1,message:"请输入账号",trigger:"blur"},{pattern:/./,message:"账号为用户昵称",trigger:"blur"},{validator:function(e,t,o){o()},trigger:"blur"}],pass:[{required:!1,message:"请输入密码",trigger:"blur"},{pattern:/./,message:"密码长度为6-20位，含有数字和字母",trigger:"blur"},{validator:function(e,t,o){o()},trigger:"blur"}],tel:[{required:!1,message:"请输入手机号",trigger:"blur"},{pattern:/^[1][3-9][0-9]{9}$/,message:"请输入正确的11位手机号码",trigger:"blur"},{validator:function(t,o,a){""===o?a():e.checkMobile(o)?a():a(new Error("请输入正确的11位手机号码"))},trigger:"blur"}],smscode:[{required:!1,message:"请输入短信验证码",trigger:"blur"},{pattern:/^[0-9]{4}$/,message:"请输入正确的四位数字验证码",trigger:"blur"},{validator:function(e,t,o){o()},trigger:"blur"}]},activeName:"first",buttonText:"获取短信验证码",isDisabled:!1,flag:!0,visible:!0,checked:!0,disabled:0,isLog:!1,isLogin:!1,logining:!1,code:""}},watch:{ruleForm:{handler:function(){this.isLog=""!==this.ruleForm.account&&""!==this.ruleForm.pass},deep:!0},"ruleForm2.tel":function(){""!==this.ruleForm2.tel?this.disabled=1:this.disabled=0},ruleForm2:{handler:function(e,t){this.isLogin=""!==e.tel&&""!==e.smscode},deep:!0}},beforeRouteLeave:function(e,t,o){this.$destroy(!0),o()},mounted:function(){var e=this,t=localStorage.getItem("token");this.$axios.get("/users/current?token="+t).then(function(t){null!==t.username?(setTimeout(function(){e.$message({message:"登录成功！",type:"success"}),e.logining=!1},400),e.$router.push({path:"/home",query:{username:t.data.username}})):(localStorage.removeItem("token"),setTimeout(function(){e.$message({message:"token已失效，请重新登录！",type:"error"}),e.logining=!1},400))})},methods:s()({},Object(i.b)("vuexLogin",{login:"login",chooseUser:"chooseUser"}),{changePass:function(e){this.visible=!("show"===e)},sendCode:function(){var e=this,t=this.ruleForm2.tel,o=60;if(this.checkMobile(t)&&(this.$axios.get("/sms?phone="+t).then(function(t){e.$layer.closeAll(),console.log(t),e.code=t.data.message,console.log(e.code),200===t.status?e.$message({message:"您的验证码已发送",type:"success"}):e.$message({message:"发送错误，请重试",type:"error"})}),this.buttonText="已发送",this.isDisabled=!0,this.flag)){this.flag=!1;var a=setInterval(function(){o--,e.buttonText=o+" s",0===o&&(clearInterval(a),e.buttonText="重新获取",e.isDisabled=!1,e.flag=!0)},1e3)}},submitSMS:function(e){var t=this;this.ruleForm2.tel,this.ruleForm2.smscode;this.code==this.ruleForm2.smscode?(setTimeout(function(){t.$message({message:"登录成功！",type:"success"}),t.logining=!1},400),this.$axios.post("login?username=admin&password=admin").then(function(e){localStorage.setItem("loginTime",Date()),localStorage.setItem("token",e.data.token),r.default.prototype.$axios=l.a,l.a.defaults.headers.common.token=localStorage.getItem("token"),t.$router.push({path:"/home",query:{username:e.data.username}})})):this.$message({message:"验证码错误，请重试",type:"error"})},submitForm:function(e){var t=this;console.log(this.ruleForm.account);var o=this.ruleForm.account,a=this.ruleForm.pass;console.log(this.ruleForm.pass),this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;""==o||""==a?console.log("不能为空"):t.$axios.post("login?username="+t.ruleForm.account+"&password="+t.ruleForm.pass).then(function(e){200===e.status&&(setTimeout(function(){t.$message({message:"登录成功！",type:"success"})},400),localStorage.setItem("loginTime",Date()),localStorage.setItem("token",e.data.token),r.default.prototype.$axios=l.a,l.a.defaults.headers.common.token=localStorage.getItem("token"),t.$router.push({path:"/home",query:{username:e.data.username}}))}).catch(function(e){setTimeout(function(){t.$message({message:e.message,type:"error"})},400)})})},gotoLoginReg:function(){this.$router.push({path:"/signin"})},gotoLoginForget:function(){this.$router.push({path:"/forget"})},checkMobile:function(e){return/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)}})}},289:function(e,t,o){var a=o(290);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o(225)("9fa5e4d0",a,!0,{})},290:function(e,t,o){var a=o(226);t=e.exports=o(224)(!1),t.push([e.i,".page[data-v-2ee312aa]{background:url("+a(o(254))+');background-size:1280px 650px;height:100%;font-size:16px;font-weight:400;-webkit-font-smoothing:antialiased}.page .login-box[data-v-2ee312aa],.page[data-v-2ee312aa]{position:absolute;width:100%;font-family:Source Sans Pro,sans-serif}.page .login-box[data-v-2ee312aa]{top:45%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:block;max-width:400px;background-color:hsla(0,0%,100%,.5);margin:0;padding:15px 35px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:.5em}.page .login-box .title[data-v-2ee312aa]{font-size:20px;line-height:50px;font-weight:700;margin:10px;text-align:center}.page .login-box[data-v-2ee312aa] .el-tabs__header{margin:0 0 30px}.page .login-box[data-v-2ee312aa] .el-tabs__nav-wrap:after{height:0}.page .login-box[data-v-2ee312aa] #tab-first:after{content:"";position:absolute;right:0;bottom:0;width:1px;height:20px;background-color:#dcdfe6;vertical-align:middle}.page .login-box .code[data-v-2ee312aa] .el-form-item__content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.page .login-box .code button[data-v-2ee312aa]{margin-left:20px;width:140px;text-align:center}.page .login-box .el-form-item[data-v-2ee312aa]:last-child{margin-bottom:6px}.page .login-box .el-button--primary[data-v-2ee312aa]:focus{background:#b8b5e2;border-color:#b8b5e2;color:hsla(0,0%,100%,.5)}.page .login-box[data-v-2ee312aa] .el-input__suffix-inner{margin-right:6px}.page .login[data-v-2ee312aa]{margin-top:-15px;font-size:12px;cursor:pointer;text-align:left}.page .login .gotoRight[data-v-2ee312aa]{float:right;color:#999}.page .login .gotoRight .hoverBlue[data-v-2ee312aa]:hover{color:#b8b5e2}',""])},291:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"page"},[o("div",{staticClass:"login-box"},[e._m(0),e._v(" "),o("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"密码登录",name:"first"}},[o("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"0"}},[o("el-form-item",{attrs:{prop:"account"}},[o("el-input",{attrs:{type:"text","prefix-icon":"el-icon-user-solid",placeholder:"请输入账号"},model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"pass"}},[o("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入密码"},model:{value:e.ruleForm.pass,callback:function(t){e.$set(e.ruleForm,"pass",t)},expression:"ruleForm.pass"}})],1),e._v(" "),o("el-form-item",[e.isLog?e.isLog?o("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.logining},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")]):e._e():o("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.logining,disabled:!0},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")])],1),e._v(" "),o("el-form-item",{staticClass:"login"},[o("label",{staticClass:"showPasswordToggle"},[o("el-checkbox",{attrs:{id:"showPasswordCheck"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("已阅读并同意《服务协议》")])],1),e._v(" "),o("div",{staticClass:"gotoRight"},[o("span",{staticClass:"hoverBlue",on:{click:e.gotoLoginForget}},[e._v("忘记密码")]),e._v(" "),o("el-divider",{attrs:{direction:"vertical"}})],1)])],1)],1),e._v(" "),o("el-tab-pane",{attrs:{label:"短信登录",name:"second"}},[o("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm2,"status-icon":"",rules:e.rules,"label-width":"0"}},[o("el-form-item",{attrs:{prop:"tel"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-mobile-phone","auto-complete":"off",placeholder:"请输入手机号"},model:{value:e.ruleForm2.tel,callback:function(t){e.$set(e.ruleForm2,"tel",t)},expression:"ruleForm2.tel"}})],1),e._v(" "),o("el-form-item",{staticClass:"code",attrs:{prop:"smscode"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-chat-dot-square",placeholder:"短信验证码"},model:{value:e.ruleForm2.smscode,callback:function(t){e.$set(e.ruleForm2,"smscode",t)},expression:"ruleForm2.smscode"}}),e._v(" "),0===e.disabled?o("el-button",{attrs:{disabled:!0},on:{click:e.sendCode}},[e._v(e._s(e.buttonText))]):1===e.disabled?o("el-button",{staticClass:"btn-color",attrs:{type:"primary",disabled:e.isDisabled},on:{click:e.sendCode}},[e._v(e._s(e.buttonText))]):e._e()],1),e._v(" "),o("el-form-item",[e.isLogin?e.isLogin?o("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.logining},on:{click:function(t){return e.submitSMS("ruleForm")}}},[e._v("登录")]):e._e():o("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.logining,disabled:!0},on:{click:function(t){return e.submitSMS("ruleForm")}}},[e._v("登录")])],1),e._v(" "),o("el-form-item",{staticClass:"login"},[o("label",{staticClass:"showPasswordToggle"},[o("el-checkbox",{attrs:{id:"showPasswordCheck"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("已阅读并同意《服务协议》")])],1),e._v(" "),o("div",{staticClass:"gotoRight"},[o("span",{on:{click:e.gotoLoginForget}},[e._v("忘记密码")]),e._v(" "),o("el-divider",{attrs:{direction:"vertical"}})],1)])],1)],1)],1)],1)])},s=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("p",{staticClass:"title"},[o("img",{attrs:{src:"https://img.icons8.com/ios/20/000000/login-rounded-down.png",alt:"登录图标"}}),e._v("\n      欢迎登录\n    ")])}],i={render:a,staticRenderFns:s};t.a=i}});